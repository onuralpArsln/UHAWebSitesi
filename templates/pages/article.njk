{% extends "layouts/base.njk" %}
{% from "widgets/comment-section.njk" import commentSection %}
{% from "widgets/related-news.njk" import relatedNews %}
{% from "widgets/ad-placeholder.njk" import adPlaceholder %}
{% from "widgets/site-header.njk" import siteHeader %}

{% block head_extra %}
<meta name="keywords" content="{{ article.keywords | join(', ') if article.keywords else '' }}">
<meta property="article:published_time" content="{{ article.publishedAt }}">
<meta property="article:modified_time" content="{{ article.updatedAt }}">
<meta property="article:author" content="{{ article.writer or article.author }}">
<meta property="article:section" content="{{ article.category }}">
{% endblock %}

{% block body %}
{% set brand = branding or {} %}
{{ siteHeader(brand, navCategories or []) }}

<main class="site-main">
  <nav class="breadcrumb container" aria-label="İz yolu">
    <ol class="breadcrumb__list">
      <li class="breadcrumb__item"><a href="/">Ana Sayfa</a></li>
      <li class="breadcrumb__item"><a href="/kategori/{{ article.category }}">{{ article.category }}</a></li>
      <li class="breadcrumb__item"><span>{{ article.title }}</span></li>
    </ol>
  </nav>

  <article class="article-view container">
    <header class="article-view__header">
      <span class="badge badge--category">{{ article.category }}</span>
      <h1 class="article-view__title">{{ article.title }}</h1>
      <div class="article-view__meta">
        <span>Yazar: {{ article.writer or article.author }}</span>
        <time datetime="{{ article.publishedAt }}">Yayın: {{ article.publishedAt | formatDate }}</time>
        {% if article.updatedAt %}
        <time datetime="{{ article.updatedAt }}">Güncelleme: {{ article.updatedAt | formatDate }}</time>
        {% endif %}
      </div>
    </header>

    {% set heroImage = article.images and article.images[0] %}
    {% if heroImage %}
    <figure class="article-view__media">
      <img
        src="{{ heroImage.lowRes }}"
        alt="{{ heroImage.alt }}"
        data-high-res="{{ heroImage.highRes }}"
        loading="eager"
      >
    </figure>
    {% endif %}

    {% if article.videoUrl %}
    <div class="article-view__video">
      <iframe
        src="{{ article.videoUrl }}"
        title="{{ article.title }} video"
        loading="lazy"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen
      ></iframe>
    </div>
    {% endif %}

    <div class="article-view__content">
      {{ article.content | safe }}
    </div>

    <div class="article-info">
      {% if article.source %}
      <div class="article-info__item"><strong>Kaynak:</strong> {{ article.source }}</div>
      {% endif %}
      {% if article.pressAnnouncementId %}
      <div class="article-info__item"><strong>Basın İlan ID:</strong> {{ article.pressAnnouncementId }}</div>
      {% endif %}
      {% if article.outlinks and article.outlinks.length %}
      <div class="article-info__item">
        <strong>Referanslar:</strong>
        <ul class="article-info__links">
          {% for link in article.outlinks %}
          <li><a href="{{ link }}" target="_blank" rel="noopener">{{ link }}</a></li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
    </div>

    {% if article.keywords %}
    <div class="article-tags">
      <h2>Etiketler</h2>
      <div class="article-tags__list">
        {% for keyword in article.keywords %}
        <span class="article-tags__tag">{{ keyword }}</span>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </article>

  <section class="container article-supplement">
    {{ adPlaceholder('article-content', 'Reklam Alanı', '300x250') }}
  </section>

  <section class="container article-supplement">
    {{ commentSection(article.id, article.comments or [], article.hasMoreComments or false) }}
  </section>

  <section class="container article-supplement">
    {{ relatedNews(relatedArticles) }}
  </section>
</main>

<footer class="site-footer">
  <div class="container">
    {% if brand.footerLogo %}
    <div class="site-footer__logo">
      <img src="{{ brand.footerLogo }}" alt="{{ brand.siteName or 'UHA News' }}">
    </div>
    {% endif %}
    <p>&copy; {{ current_year }} {{ brand.siteName or 'UHA News' }}. Tüm hakları saklıdır.</p>
  </div>
</footer>
{% endblock %}

